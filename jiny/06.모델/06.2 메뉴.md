# 메뉴
뤱사이트는 여러 종류의 서비스와 페이지들의 경로가 있습니다. 페이지의 경로는 쉽게 찾아 이동할 수 있는 기능으로 메뉴 네비게이션 기능이 있습니다.
메뉴 네비게이션을 html로 구현하는 방법은 다양합니다. 단순한 리스트 방법, CSS & javascript를 이용한 동적인 처리 방법등 사이트마다 구성방식들은 다 다릅니다.

또한 메뉴들은 모든 페이지들에게 공통적으로 표시되는 내용입니다.


## 데이터
모든 페이지에 메뉴를 표현하기 위해서는 데이터가 필요로 합니다. 공용된 메뉴의 데이터를 저장하여 사용을 처리하면 편리합니다.
데이터는 다양한 방식으로 저장을 할 수 있습니다.

JSON 포맷 또는 PHP 배열을 방식의 파일로 저장을 할 수 있습니다.
이렇게 저장된 포맷은 컨트롤러 또는 다른 곳에서 읽어서 처리를 할 수 있습니다.


## 메뉴 페키지
`지니PHP`는 메뉴 데이터 파일을 읽고 처리할 수 있는 별도의 전용 페키지를 제공합니다. 이 패키지는 기본적으로 설치가 되어 있습니다.
또는 

```php
composer require jiny/menu
```

형태로 추가 설치를 할 수도 있습니다.


## 저장위치
메뉴 데이터의 기본 저장폴더는 `resource/menu`입니다. 기본 폴더의 위치는 사이트 환경설정 파일인 `site.ini`에서 경로를 지정할 수 있습니다.

```php
# 메뉴설정
menu_type = json
menu_path = ./resource/menu/menu.json
```

메뉴파일의 타입과 경로를 지정합니다. 

사이트의 환경설정파일에 메뉴의 리소스정로를 정의함으로서 보다 동적 메뉴처리가 가능합니다. 예를들어, 한개의 사이트가 2개의 도메인으로 연결이 되어 있다고 생각합니다.
부팅과정에서 도메인에 대한 설정파일을 다르게 읽어오면, 메뉴 리소스도 다르게 동작을 하게 됩니다.


## 데이터 구조
메뉴의 배열의 구조의 작성은 자유롭습니다. 메뉴의 구조의 접근은 템플릿 언어 또는 PHP에서 개발자가 직접 억세스 하기 때문입니다.


## 헬퍼함수
메뉴의 데이터 파일을 직접 읽어서 처리를 하실 수도 있지만, 메뉴 페키지는 메뉴의 데이터를 처리할 수 있는 헬퍼 함수를 제공합니다.

메뉴의 헬퍼 함수는 `vendor/jiny/menu/src/Helpers/Helper.php`에 저장이 되어 있습니다.

```php
if (! function_exists('menu')) {
    /**
     * 메뉴의 객체를 생성후, 데이터를 읽어옵니다.
     */
    function menu() {
        $Menu = Registry::create(\Jiny\Menu\Menu::class,"Menu");
        return $Menu->getTree();
    }
}
```

레지스트리에서 메뉴 클래스의 인스턴스를 찾아 파일을 읽어오는 메소드를 실행을 하게 됩니다.


## 데이터 읽기
프레임워크 안에서 메뉴를 읽은 방법은 매우 간단합니다. `menu()` 헬퍼 함수만 호출하면 됩니다.
메뉴헬퍼 함수는 메뉴파일을 읽어서 배열로 반환하게 됩니다.

```php
// 메뉴 데이터를 읽어옵니다.
$viewData['menus'] = menu();
```

위와 같이 메뉴의 데이터를 읽어서, `뷰`의 데이터에게 전달을 하면 뷰는 메뉴의 데이터를 같이 `템플릿`으로 전달합니다.
템플릿은 전달받은 메뉴 데이터를 처리하여 메뉴를 구성할 수 있습니다.

뷰의 데이터 배열의 `키`는 템플릿에서 인식할 수 있는 키값이 됩니다.


## 템플릿 처리
뷰로 부터 전달받은 메뉴 데이터를 템플릿에서 처리를 할 수 있습니다.

다음은 테마 해더에서 메뉴를 처리하는 Liquid 템플릿 처리의 예 입니다.

```php
<div class="collapse navbar-collapse" id="navbarResponsive">
            
    {% if menus %}
        <ul class="navbar-nav ml-auto">
        {% for menu in menus %}
            <li class="nav-item">
                <a class="nav-link" href='{{ menu.href }}'>
                {% if sys.language == "en" %}
                    {{ menu.en }}
                {% else %}
                    {{ menu.ko }}
                {% endif %}
                </a>
            </li>      
        {% endfor %}
        </ul>
    {% endif %}
    
</div>
```

Liquid 템플릿 언어에서는 뷰로 전달되는 배열의 `키`값으로 선택을 하게 됩니다.
기본적으로 메뉴의 키값은 `menus`로 사용을 합니다.

키 이름을 변경하고자 할때에는 뷰의 배열의 키명을 변경하면 됩니다.
